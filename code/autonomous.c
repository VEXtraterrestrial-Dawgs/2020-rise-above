#pragma config(Sensor, port1,  gyro,           sensorVexIQ_Gyro)
#pragma config(Sensor, port3,  color,          sensorVexIQ_ColorGrayscale)
#pragma config(Sensor, port6,  touch,          sensorVexIQ_LED)
#pragma config(Motor,  motor4,          leftWheels,    tmotorVexIQ, PIDControl, driveLeft, encoder)
#pragma config(Motor,  motor7,          hDrive,        tmotorVexIQ, PIDControl, reversed, encoder)
#pragma config(Motor,  motor8,          rightArm,      tmotorVexIQ, PIDControl, encoder)
#pragma config(Motor,  motor10,         leftArm,       tmotorVexIQ, PIDControl, reversed, encoder)
#pragma config(Motor,  motor12,         rightWheels,   tmotorVexIQ, PIDControl, reversed, driveRight, encoder)
//*!!Code automatically generated by 'ROBOTC' configuration wizard               !!*//

#include "autonomousfn.c"

#define TEST_MODE

/*bool testSequence() {
	displayTextLine(1, "Starting");
	displayTextLine(2, "H-Drive");
	waitForLED();
	displayTextLine(1, "Running");
	setTouchLEDColor(touch, colorYellow);
	setTouchLEDColor(touch, moveHDrive(200)?colorDarkBlue:colorRed);
	displayTextLine(1, "Starting");
	displayTextLine(2, "Arm");
	waitForLED();
	displayTextLine(1, "Running");
	setTouchLEDColor(touch, colorYellow);
	setTouchLEDColor(touch, moveArm(225)?colorDarkBlue:colorRed);
	displayTextLine(1, "Starting");
	displayTextLine(2, "Drive");
	waitForLED();
	displayTextLine(1, "Running");
	setTouchLEDColor(touch, colorYellow);
	setTouchLEDColor(touch, driveRobot(300)?colorDarkBlue:colorRed);
	displayTextLine(1, "Starting");
	displayTextLine(2, "Turn");
	waitForLED();
	displayTextLine(1, "Running");
	setTouchLEDColor(touch, colorYellow);
	setTouchLEDColor(touch, turnRobot(90)?colorDarkBlue:colorRed);
	displayTextLine(1, "Finished");
	displayTextLine(2, "Tests");
	return true;
}*/

bool autonomousStrategy(int row) {
	displayTextLine(1, "Starting %s Row", (row == 1) ? "Purple" : "Teal");
	waitForLED();
	setTouchLEDRGB(touch, 255, 240, 122);

	MOVE_ARM(ARM_STACK);

	// H_DRIVE and TURN must have row as the second parameter

	// H-Drive riser into goal

	H_DRIVE(610, row);
	H_DRIVE(-530, row);
 	DRIVE(128);
	sleep(50);

	// Lift and stack riser

	TURN(90, row);
	MOVE_ARM(ARM_LIFT);
	DRIVE(314);
	MOVE_ARM(ARM_HIGH);
	DRIVE(-30);
	TURN(55, row);
	DRIVE(85);
	MOVE_ARM(ARM_STACK);

	// Back out and push riser into middle goal

	DRIVE(-350);
	TURN(-55, row);
	MOVE_ARM(ARM_HIGH);
	H_DRIVE(-300, row);
	TURN(0, row);
	DRIVE(330);
	DRIVE(-290);
	TURN(0, row);

	// Push in the riser to the final goal

	TURN(0, row);
	H_DRIVE(-850, row);
	TURN(0, row);
	DRIVE(330);
	DRIVE(-250);

	displayTextLine(1, "Finished Program");
	setTouchLEDRGB(touch, 54, 255, 90);

	return true;
}

task main()
{
	displayTextLine(1, "Press the LED to Calibrate Gyro");
	setTouchLEDRGB(touch, 255, 17, 0);
	waitForLED();
	calibrateGyro();
	setMotorBrakeMode(leftArm, motorHold);
	setMotorBrakeMode(rightArm, motorHold);
	CLEAR_LOG();
	setMotorEncoderUnits(encoderCounts);
	resetMotorEncoder(leftArm);
	resetMotorEncoder(rightArm);
	setTouchLEDRGB(touch, 84, 122, 138);

	//testSequence();
	autonomousStrategy(PURPLE);
	setTouchLEDRGB(touch, 187, 237, 235);
	autonomousStrategy(TEAL);
}
